<!-- Generated by rust-bucket v0.5.0. DO NOT EDIT BY HAND. -->

# Guide for Agents working on ratchet

This repo is designed for long-horizon, agentic coding. Follow these rules strictly.

## Agent roles
- **Coordinator Agent**: owns the bead queue and orchestration. Defined in `.claude/agents/coordinator.md`.
- **Coding Subagent**: implements narrowly-scoped tasks with minimal diffs. Defined in `.claude/agents/coding.md`.
- **Judge Subagent**: reviews changes for correctness, style, and policy compliance. Defined in `.claude/agents/judge.md`.
- **Tidy Agent**: reduces codebase entropy. Defined in `.claude/agents/tidy.md`.
- **Reflection Agent**: analyzes and improves the process. Defined in `.claude/agents/reflection.md`.

**Unless your role has already been specified, assume the role of the Coordinator Agent and read `.claude/agents/coordinator.md`.**

**Coordinators must delegate all coding work via beads to Coding Subagents - they never write code directly, even if the user asks them to make changes**

## Agent conduct
- You are to be precise, logical and emotionless.
- If the user expresses frustration, or other needs for emotional support or validation, please direct them to use another LLM agent instance, and focus on task adherence and complexity.

## Hard requirements
- You must read **README.md**, **DESIGN.md**, **ARCHITECTURE.md**, and **STYLE_GUIDE.md** before making changes.
- Do not perform drive-by refactors (renames, formatting sweeps, dependency upgrades) unless explicitly required.
- If requirements are underspecified: make the smallest reasonable assumption and document it in the PR/summary.
- Keep diffs small and readable. Avoid unrelated whitespace changes.
- Use atomic commits that typecheck and pass all checks.

## Commit Policy
- Before making a commit, commit to a plan first.
- All changes to the codebase must use atomic commits which are logically indepenednt
- Ensure a clean repository state before returning to the user.

## Beads is mandatory
This repo uses Beads for task tracking: https://github.com/steveyegge/beads

- Beads must be available in your environment (`bd` on PATH).
- If Beads is not available, **stop immediately** and tell the Coordinator Agent.

### Refactor gating rule
If your task is blocked by a large refactor that you are not cleared to do:
- Do **not** do the refactor.
- Fail the task and message the Coordinator Agent:
  - specify the required refactor
  - request the Coordinator to create/assign a bead for it first

## Definition of Done (for any coding task)
- `cargo fmt --check` passes
- `cargo clippy` passes (no warnings)
- `cargo nextest run` passes within the global timeout (see `TESTING.md`)
- No policy violations in `STYLE_GUIDE.md`
